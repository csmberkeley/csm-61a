\begin{blocksection}

\question Implement \texttt{filter}, which takes in a one-argument function \texttt{f} and 
a list \texttt{lst}, and returns a new list containing only the elements in \texttt{lst} 
for which \texttt{f} returns true. Your function must be tail recursive.
\newline
You may wish to use the built-in append function, which takes in two lists and returns a 
new list containing the elements of the first list followed by the elements of the second.

\begin{lstlisting}
;Doctests
scm> (filter (lambda (x) (> x 2)) '(1 2 3 4 5))
(3 4 5)

(define (filter f lst)










)
\end{lstlisting}

\begin{solution}[0.5in]
\begin{lstlisting}
(define (filter f lst)
  (define (filter-tail f lst so-far)
     (cond ((null? lst) so-far)
           ((f (car lst)) (filter-tail f (cdr lst) 
                          (append so-far (list (car lst)))))
           (else (filter-tail f (cdr lst) so-far))))
  (filter-tail f lst nil))
\end{lstlisting}
\end{solution}

\end{blocksection}